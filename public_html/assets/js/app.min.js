var map,loadingAircrafts=!1,aircraftMarker={},activeAircrafts={},aircraftLastSaw={},settedTime=null,aircraftIcon=L.icon({iconUrl:"assets/images/aircraft.png",iconSize:[16,16],shadowSize:[16,16],iconAnchor:[8,8],shadowAnchor:[64,64],popupAnchor:[0,-8]});function AddMap(){map=L.map("map").setView([47.517141,9.89126],10),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(map),L.marker(["47.517141","9.891260"]).addTo(map)}function SetTimeDatePicker(){SetCurrentTimeToPicker(),setInterval(SetCurrentTimeToPicker,1e3),$("#datetimepicker .datetimepicker").change(function(){settedTime=$("#datetimepicker .datetimepicker").val(),ResetAircrafts(),SetOwnAircrafts()}),$("#datetimepicker .resetbutton").click(function(){settedTime=null,ResetAircrafts(),SetOwnAircrafts()})}function ResetAircrafts(){$.each(aircraftMarker,function(t,e){map.removeLayer(e),delete aircraftMarker[t]}),aircraftLastSaw={},activeAircrafts=[],aircraftMarker={}}function SetCurrentTimeToPicker(){var t,e,r,a,i,c,n;null===settedTime&&(e=(t=new Date).getDate(),r=t.getMonth()+1,a=t.getFullYear(),i=t.getHours(),e<10&&(e="0"+e),r<10&&(r="0"+r),(c=t.getMinutes())<10&&(c="0"+c),(n=t.getSeconds())<10&&(n="0"+n),i<10&&(i="0"+i),$("#datetimepicker .datetimepicker").val(a+"-"+r+"-"+e+"T"+i+":"+c+":"+n))}function SetOwnAircrafts(){var t;loadingAircrafts||(activeAircrafts=[],t="",null!==settedTime&&(t="?time="+Date.parse(settedTime)/1e3),$.getJSON("proxy.php?p=/api/states/own"+t,function(t){if(null!==t.states&&0<t.states.length)for(var e=0;e<t.states.length;e++)activeAircrafts[activeAircrafts.length]=t.states[e][0],aircraftLastSaw[t.states[e][0]]=Date.now(),SetAircraft(t.states[e]);RemoveAircrafts()}))}function SetAircraft(t){var e,r;null!==t[5]&&null!==t[6]&&(e=t[0],void 0===aircraftMarker[e]?aircraftMarker[e]=L.marker([t[6],t[5]],{icon:aircraftIcon}).addTo(map).bindPopup(GetPopupText(t)):(r=new L.LatLng(t[6],t[5]),aircraftMarker[e].setLatLng(r),aircraftMarker[e]._popup.setContent(GetPopupText(t))),aircraftMarker[e].setRotationAngle(t[10]-45))}function RemoveAircrafts(){$.each(aircraftMarker,function(t,e){-1===activeAircrafts.indexOf(t)&&aircraftLastSaw[t]<=Date.now()-2e4&&(map.removeLayer(e),delete aircraftMarker[t])})}function GetPopupText(t){var e='<b><a href="https://www.flightradar24.com/'+t[1]+'" target="_blank">'+t[1]+"</a></b><br>";return e+="Alt: "+t[13]+" m<br>",e+="Speed: "+Math.round(3.6*t[9])+" km/h<br>",e+="VR: "+t[11]+" m/s<br>"}
//# sourceMappingURL=app.min.js.map